# data-analyst-agent-app
8 å‘¨è¯¾ç¨‹ä½œä¸šï¼šæ•°æ®åˆ†æå¸ˆæ™ºèƒ½ä½“ APPï¼ˆå‰ç«¯ HTML + åç«¯ Python+MySQLï¼‰
# æ•°æ®åˆ†ææ™ºèƒ½ä½“å¤šç«¯åº”ç”¨

ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ•°æ®åˆ†ææ™ºèƒ½ä½“åº”ç”¨ï¼Œæ”¯æŒå¤šå¹³å°è®¿é—®ï¼Œæä¾›ä»£ç ç”Ÿæˆã€æ‰§è¡Œã€å¯è§†åŒ–ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **æ™ºèƒ½ä»£ç ç”Ÿæˆ**ï¼šåŸºäºæ•°æ®åˆ†æéœ€æ±‚è‡ªåŠ¨ç”ŸæˆPythonä»£ç 
- **ä»£ç æ‰§è¡Œ**ï¼šåœ¨çº¿æ‰§è¡Œç”Ÿæˆçš„ä»£ç ï¼Œæ”¯æŒæ•°æ®å¤„ç†å’Œå¯è§†åŒ–
- **ä»»åŠ¡ç®¡ç†**ï¼šä¿å­˜å’Œç®¡ç†å†å²åˆ†æä»»åŠ¡
- **å¤šå¹³å°æ”¯æŒ**ï¼šWebã€Windowsæ¡Œé¢åº”ç”¨ã€Androidã€iOS

### ğŸ› ï¸ æŠ€æœ¯ç‰¹æ€§
- **åç«¯API**ï¼šFastAPIæ„å»ºçš„é«˜æ€§èƒ½RESTful API
- **å‰ç«¯æ¡†æ¶**ï¼šFlutterå¼€å‘çš„è·¨å¹³å°åº”ç”¨
- **æ•°æ®å­˜å‚¨**ï¼šMySQLæ•°æ®åº“æŒä¹…åŒ–å­˜å‚¨
- **AIé©±åŠ¨**ï¼šé›†æˆé€šä¹‰åƒé—®APIå®ç°æ™ºèƒ½ä»£ç ç”Ÿæˆ
- **ä»£ç é«˜äº®**ï¼šæ”¯æŒPythonä»£ç è¯­æ³•é«˜äº®æ˜¾ç¤º
- **æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒä¸Šä¼ æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æ

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šFastAPI ğŸƒ
- **è¯­è¨€**ï¼šPython 3.9 ğŸ
- **æ•°æ®åº“**ï¼šMySQL ğŸ—„ï¸
- **ORM**ï¼šSQLAlchemy ğŸ”—
- **AIæ¥å£**ï¼šé€šä¹‰åƒé—®API ğŸ§ 
- **ä»£ç æ‰§è¡Œ**ï¼šå®‰å…¨æ²™ç®±ç¯å¢ƒ

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šFlutter 3.38.4 ğŸ“±
- **è¯­è¨€**ï¼šDart ğŸ¯
- **ç½‘ç»œè¯·æ±‚**ï¼šhttp ğŸ“¡
- **çŠ¶æ€ç®¡ç†**ï¼šProvider ğŸ”„
- **ä»£ç é«˜äº®**ï¼šflutter_highlight ğŸŒˆ
- **æ–‡ä»¶é€‰æ‹©**ï¼šfile_picker ğŸ“

## é¡¹ç›®ç»“æ„
data-analyst-agent-app/
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
â”œâ”€â”€ .gitignore              # Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ LICENSE                 # é¡¹ç›®è®¸å¯è¯
â”œâ”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ conda_env.yml           # Condaç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ ä»£ç .docx            # ä»£ç æ–‡æ¡£
â”‚   â”œâ”€â”€ ä»£ç .pdf             # ä»£ç æ–‡æ¡£ï¼ˆPDFæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ æ•°æ®åˆ†ææ™ºèƒ½ä½“å¤šç«¯å¼€å‘æ¦‚è¦è®¾è®¡è¯´æ˜ä¹¦.docx  # æ¦‚è¦è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ æ•°æ®åˆ†ææ™ºèƒ½ä½“å¤šç«¯å¼€å‘æ¦‚è¦è®¾è®¡è¯´æ˜ä¹¦.pdf   # æ¦‚è¦è®¾è®¡æ–‡æ¡£ï¼ˆPDFæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ æ•°æ®åˆ†ææ™ºèƒ½ä½“å¤šç«¯å¼€å‘é¡¹ç›® - è¯¦ç»†è®¾è®¡æ–‡æ¡£.pdf  # è¯¦ç»†è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ è°ƒç ”æŠ¥å‘Š.docx        # è°ƒç ”æŠ¥å‘Š
â”‚   â”œâ”€â”€ è°ƒç ”æŠ¥å‘Š.pdf         # è°ƒç ”æŠ¥å‘Šï¼ˆPDFæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ï¼ˆSRSï¼‰- æ•°æ®åˆ†ææ™ºèƒ½ä½“å¤šç«¯å¼€å‘ï¼ˆå‰å››éƒ¨åˆ†ï¼‰1.docx  # éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦
â”‚   â””â”€â”€ éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ï¼ˆSRSï¼‰- æ•°æ®åˆ†ææ™ºèƒ½ä½“å¤šç«¯å¼€å‘ï¼ˆå‰å››éƒ¨åˆ†ï¼‰1.pdf   # éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ï¼ˆPDFæ ¼å¼ï¼‰
â”œâ”€â”€ feature/                # ä¸»åŠŸèƒ½ç›®å½•
â”‚   â”œâ”€â”€ client/             # å®¢æˆ·ç«¯ä»£ç 
â”‚   â”‚   â”œâ”€â”€ electron_desktop/  # Electronæ¡Œé¢åº”ç”¨ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ flutter_app/    # Flutterè·¨å¹³å°åº”ç”¨
â”‚   â”‚       â”œâ”€â”€ .dart_tool/  # Dartå·¥å…·ç¼“å­˜
â”‚   â”‚       â”œâ”€â”€ .flutter-plugins-dependencies  # Flutteræ’ä»¶ä¾èµ–ä¿¡æ¯
â”‚   â”‚       â”œâ”€â”€ .gitignore   # Flutteré¡¹ç›®Gitå¿½ç•¥é…ç½®
â”‚   â”‚       â”œâ”€â”€ .metadata    # Flutteré¡¹ç›®å…ƒæ•°æ®
â”‚   â”‚       â”œâ”€â”€ README.md    # Flutteré¡¹ç›®è¯´æ˜
â”‚   â”‚       â”œâ”€â”€ analysis_options.yaml  # Dartä»£ç åˆ†æé…ç½®
â”‚   â”‚       â”œâ”€â”€ android/     # Androidå¹³å°ä»£ç 
â”‚   â”‚       â”œâ”€â”€ build/       # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â”‚       â”œâ”€â”€ code_generator.iml  # IDEé¡¹ç›®é…ç½®æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ flutter_app.iml/  # IDEé¡¹ç›®é…ç½®æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ ios/         # iOSå¹³å°ä»£ç 
â”‚   â”‚       â”œâ”€â”€ lib/         # Flutteræ ¸å¿ƒä»£ç 
â”‚   â”‚       â”œâ”€â”€ linux/       # Linuxå¹³å°ä»£ç 
â”‚   â”‚       â”œâ”€â”€ macos/       # macOSå¹³å°ä»£ç 
â”‚   â”‚       â”œâ”€â”€ pubspec.lock  # ä¾èµ–ç‰ˆæœ¬é”å®šæ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ pubspec.yaml  # Flutterä¾èµ–é…ç½®
â”‚   â”‚       â”œâ”€â”€ test/        # æµ‹è¯•ä»£ç 
â”‚   â”‚       â”œâ”€â”€ web/         # Webå¹³å°ä»£ç 
â”‚   â”‚       â””â”€â”€ windows/     # Windowså¹³å°ä»£ç 
â”‚   â””â”€â”€ server/              # æœåŠ¡å™¨ç«¯ä»£ç 
â”‚       â”œâ”€â”€ app/             # FastAPIåº”ç”¨ä¸»ç›®å½•
â”‚       â”‚   â”œâ”€â”€ __pycache__/  # Pythonç¼–è¯‘ç¼“å­˜
â”‚       â”‚   â”œâ”€â”€ api/         # APIæ¥å£å®šä¹‰
â”‚       â”‚   â”‚   â”œâ”€â”€ analysis.py  # åˆ†æç›¸å…³æ¥å£
â”‚       â”‚   â”‚   â”œâ”€â”€ code_api.py  # ä»£ç ç”Ÿæˆæ¥å£
â”‚       â”‚   â”‚   â”œâ”€â”€ code_exec_api.py  # ä»£ç æ‰§è¡Œæ¥å£
â”‚       â”‚   â”‚   â”œâ”€â”€ task_api.py  # ä»»åŠ¡ç®¡ç†æ¥å£
â”‚       â”‚   â”‚   â””â”€â”€ user.py  # ç”¨æˆ·ç›¸å…³æ¥å£
â”‚       â”‚   â”œâ”€â”€ app/         # åº”ç”¨æ ¸å¿ƒé…ç½®
â”‚       â”‚   â”œâ”€â”€ backup.sql   # æ•°æ®åº“å¤‡ä»½æ–‡ä»¶
â”‚       â”‚   â”œâ”€â”€ config/      # é…ç½®æ–‡ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ database.py  # æ•°æ®åº“é…ç½®
â”‚       â”‚   â”‚   â””â”€â”€ db_config.py  # æ•°æ®åº“è¿æ¥é…ç½®
â”‚       â”‚   â”œâ”€â”€ logs/        # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚       â”‚   â”œâ”€â”€ main.py      # FastAPIåº”ç”¨å…¥å£
â”‚       â”‚   â”œâ”€â”€ models/      # æ•°æ®æ¨¡å‹
â”‚       â”‚   â”‚   â””â”€â”€ analysis_record.py  # åˆ†æè®°å½•æ¨¡å‹
â”‚       â”‚   â”œâ”€â”€ services/    # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚       â”‚   â”‚   â”œâ”€â”€ code_executor.py  # ä»£ç æ‰§è¡ŒæœåŠ¡
â”‚       â”‚   â”‚   â”œâ”€â”€ db_service.py  # æ•°æ®åº“æœåŠ¡
â”‚       â”‚   â”‚   â””â”€â”€ llm_service.py  # LLMæœåŠ¡ï¼ˆæœ¬åœ°æ¨¡å‹ï¼Œæœªè¢«ç”Ÿäº§ä½¿ç”¨ï¼‰
â”‚       â”‚   â””â”€â”€ utils/       # å·¥å…·å‡½æ•°
â”‚       â”‚       â”œâ”€â”€ auth.py  # è®¤è¯å·¥å…·
â”‚       â”‚       â””â”€â”€ logger.py  # æ—¥å¿—å·¥å…·
â”‚       â”œâ”€â”€ db/              # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚       â”‚   â””â”€â”€ init_db.sql  # æ•°æ®åº“åˆå§‹åŒ–SQL
â”‚       â”œâ”€â”€ run.py           # åç«¯è¿è¡Œè„šæœ¬
â”‚       â”œâ”€â”€ test_llm.py      # LLMæµ‹è¯•è„šæœ¬
â”‚       â””â”€â”€ test_local_qwen.py  # æœ¬åœ°åƒé—®æ¨¡å‹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ start_all.bat           # Windowsä¸€é”®å¯åŠ¨è„šæœ¬
â”œâ”€â”€ temp/                   # ä¸´æ—¶æ–‡ä»¶ç›®å½•
â””â”€â”€ test_api.http           # APIæµ‹è¯•æ–‡ä»¶

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

#### åç«¯ç¯å¢ƒ
- Python 3.9+
- MySQL 5.7+
- Condaï¼ˆæ¨èï¼‰æˆ–è™šæ‹Ÿç¯å¢ƒ

#### å‰ç«¯ç¯å¢ƒ
- Flutter SDK 3.0+
- Dart 3.0+
- å„å¹³å°å¼€å‘ç¯å¢ƒï¼ˆå¯é€‰ï¼‰

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/yourusername/data-analyst-agent-app.git
cd data-analyst-agent-app
```

#### 2. é…ç½®åç«¯ç¯å¢ƒ

##### ä½¿ç”¨Condaï¼ˆæ¨èï¼‰
```bash
# åˆ›å»ºå¹¶æ¿€æ´»ç¯å¢ƒ
conda env create -f conda_env.yml
conda activate data_agent
```

##### ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»ç¯å¢ƒï¼ˆWindowsï¼‰
venv\Scripts\activate

# æ¿€æ´»ç¯å¢ƒï¼ˆLinux/macOSï¼‰
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 3. é…ç½®æ•°æ®åº“

1. åˆ›å»ºMySQLæ•°æ®åº“
```sql
CREATE DATABASE data_analyst_agent CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

2. ä¿®æ”¹æ•°æ®åº“é…ç½®
ç¼–è¾‘ `feature/server/app/config/db_config.py` æ–‡ä»¶ï¼š
```python
DB_CONFIG = {
    "host": "localhost",
    "port": 3306,
    "user": "root",          # æ›¿æ¢ä¸ºä½ çš„MySQLç”¨æˆ·å
    "password": "123456",  # æ›¿æ¢ä¸ºä½ çš„MySQLå¯†ç 
    "database": "data_analyst_agent",
    "pool_size": 10,
    "pool_recycle": 3600,
    "echo": False
}
```

3. åˆå§‹åŒ–æ•°æ®åº“
```bash
python feature/server/app/services/db_service.py
```

#### 4. é…ç½®AI API

ç¼–è¾‘ `feature/server/app/api/code_api.py` æ–‡ä»¶ï¼Œé…ç½®é€šä¹‰åƒé—®APIå¯†é’¥ï¼š
```python
# é€šä¹‰åƒé—®APIé…ç½®ï¼ˆå…¼å®¹OpenAIæ¥å£ï¼‰
THIRD_PARTY_API_KEY = "your-api-key"  # æ›¿æ¢ä¸ºä½ çš„APIå¯†é’¥
BASE_URL = "https://dashscope.aliyuncs.com/compatible-mode/v1"
```

### è¿è¡Œé¡¹ç›®

#### ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆWindowsï¼‰
```bash
start_all.bat
```

#### æ‰‹åŠ¨å¯åŠ¨

1. å¯åŠ¨åç«¯æœåŠ¡
```bash
cd feature/server/app
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

2. å¯åŠ¨Flutter Webå¼€å‘æœåŠ¡å™¨
```bash
cd feature/client/flutter_app
flutter run -d chrome
```

3. å¯åŠ¨Windowsæ¡Œé¢åº”ç”¨
```bash
cd feature/client/flutter_app
flutter run -d windows
```

## è®¿é—®åœ°å€

- **åç«¯API**ï¼šhttp://localhost:8000
- **APIæ–‡æ¡£**ï¼šhttp://localhost:8000/docs
- **Webå‰ç«¯**ï¼šå°†åœ¨Chromeæµè§ˆå™¨ä¸­è‡ªåŠ¨æ‰“å¼€

## éƒ¨ç½²æ–¹æ¡ˆ

### åç«¯éƒ¨ç½²

#### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. ä½¿ç”¨Gunicornå¯åŠ¨FastAPI
```bash
gunicorn -w 4 -k uvicorn.workers.UvicornWorker main:app --bind 0.0.0.0:8000
```

2. ä½¿ç”¨Nginxåå‘ä»£ç†
```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location / {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### å‰ç«¯éƒ¨ç½²

#### Webå‰ç«¯éƒ¨ç½²

1. æ‰“åŒ…Webåº”ç”¨
```bash
cd feature/client/flutter_app
flutter build web --release
```

2. éƒ¨ç½²åˆ°Nginx
å°† `build/web` ç›®å½•ä¸‹çš„æ–‡ä»¶å¤åˆ¶åˆ°Nginxçš„ç½‘ç«™æ ¹ç›®å½•ã€‚

#### Windowsæ¡Œé¢åº”ç”¨éƒ¨ç½²

1. æ‰“åŒ…Windowsåº”ç”¨
```bash
cd feature/client/flutter_app
flutter build windows --release
```

2. åˆ†å‘åº”ç”¨
å°† `build/windows/runner/Release/` ç›®å½•ä¸‹çš„æ–‡ä»¶æ‰“åŒ…åˆ†å‘ç»™ç”¨æˆ·ã€‚

## ä¸»è¦APIæ¥å£

### ä»£ç ç”Ÿæˆæ¥å£
- **URL**: `/api/code/generate`
- **Method**: `POST`
- **Description**: æ ¹æ®éœ€æ±‚ç”ŸæˆPythonä»£ç 

### ä»£ç æ‰§è¡Œæ¥å£
- **URL**: `/api/code/exec`
- **Method**: `POST`
- **Description**: æ‰§è¡ŒPythonä»£ç å¹¶è¿”å›ç»“æœ

### ä»»åŠ¡åˆ—è¡¨æ¥å£
- **URL**: `/api/task/list`
- **Method**: `POST`
- **Description**: è·å–ç”¨æˆ·ä»»åŠ¡åˆ—è¡¨

### ä»»åŠ¡è¯¦æƒ…æ¥å£
- **URL**: `/api/task/detail`
- **Method**: `POST`
- **Description**: è·å–ä»»åŠ¡è¯¦æƒ…

## è´¡çŒ®æŒ‡å—

1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## è”ç³»æ–¹å¼

- é¡¹ç›®ç»´æŠ¤è€…ï¼š[Your Name]
- é¡¹ç›®åœ°å€ï¼š[https://github.com/yourusername/data-analyst-agent-app](https://github.com/yourusername/data-analyst-agent-app)

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-12-24)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒä»£ç ç”Ÿæˆã€æ‰§è¡ŒåŠŸèƒ½
- æ”¯æŒå¤šå¹³å°å‰ç«¯è®¿é—®
- é›†æˆé€šä¹‰åƒé—®API
